# é¡¹ç›®æ€»ç»“ - API å“ˆå¸ŒéšæœºåŒ–é›¶æ£€æµ‹å·¥å…·

> **ç‰ˆæœ¬**: 2.1 | **æœ€åæ›´æ–°**: 2026-01-29

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

### å››å±‚ç»•è¿‡æŠ€æœ¯

| æŠ€æœ¯ | æ•ˆæœ | çŠ¶æ€ |
|------|------|------|
| API å“ˆå¸ŒéšæœºåŒ– | ç»•è¿‡ 96% (53/55) | âœ… å·²å®ç° |
| DLL åç§°å¤§å†™åŒ– | ç ´åæ ˆå­—ç¬¦ä¸²ç‰¹å¾ | âœ… å·²å®ç° |
| CLD æŒ‡ä»¤ç§»åŠ¨ | ç ´åé¦–æŒ‡ä»¤ç‰¹å¾ | âœ… å·²å®ç° (å®‰å…¨æ›¿æ¢) |
| ToUpper å‡½æ•°å˜å½¢ | ç»•è¿‡ YARA æ£€æµ‹ | âœ… å·²å®ç° |

**ç»„åˆæ•ˆæœ**: **0/55 æ£€æµ‹** + **YARA ç»•è¿‡** âœ…

---

## ğŸ“ é¡¹ç›®æ–‡ä»¶

### Python è„šæœ¬

```
â”œâ”€â”€ apihash_zero_detection.py   # â­ ä¸»è„šæœ¬ (é›¶æ£€æµ‹ç»•è¿‡)
â”œâ”€â”€ apihash_lists.py            # API åˆ—è¡¨æ¨¡å—
â”œâ”€â”€ dll_parser.py               # DLL è§£ææ¨¡å—
â””â”€â”€ apihashreplace.py           # åŸå§‹è„šæœ¬ (å…¼å®¹)
```

### æ–‡æ¡£

```
â”œâ”€â”€ é›¶æ£€æµ‹ä½¿ç”¨æŒ‡å—.md           # ä¸»è¦ä½¿ç”¨æŒ‡å—
â”œâ”€â”€ YARAç»•è¿‡æŒ‡å—.md             # YARA ç»•è¿‡è¯¦è§£
â”œâ”€â”€ åŠ¨æ€DLLè§£ææŒ‡å—.md          # DLL è§£æåŠŸèƒ½
â””â”€â”€ é¡¹ç›®æ€»ç»“.md                 # æœ¬æ–‡ä»¶
```

### ç¼“å­˜/é…ç½®

```
â”œâ”€â”€ dll_cache.json              # API ç¼“å­˜ (è‡ªåŠ¨ç”Ÿæˆ)
â””â”€â”€ rorHashingDetection.yara    # YARA æ£€æµ‹è§„åˆ™
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…

```bash
# å®‰è£…ä¾èµ–
pip install pefile

# ç”Ÿæˆ API ç¼“å­˜
python dll_parser.py -v
```

### ä½¿ç”¨

```bash
# æ¨èç”¨æ³• (æœ€å®‰å…¨)
python apihash_zero_detection.py -a x64 -i beacon.bin \
  --uppercase-dlls --transform-toupper

# å®Œæ•´é›¶æ£€æµ‹
python apihash_zero_detection.py -a x64 -i beacon.bin --zero-detection -v
```

---

## ğŸ”§ æŠ€æœ¯è¦ç‚¹

### 1. CLD ç§»åŠ¨ - åªæ›¿æ¢ä¸æ’å…¥

```python
# âœ— é”™è¯¯ (ä¼šç ´åç›¸å¯¹è·³è½¬)
shellcode_array.insert(safe_offset, 0xfc)

# âœ“ æ­£ç¡® (ä¿æŒå¤§å°ä¸å˜)
shellcode_array[nop_pos] = 0xfc  # æ›¿æ¢å·²æœ‰çš„ NOP
```

### 2. ToUpper å˜å½¢ - ç»•è¿‡ YARA

```python
# YARA æ£€æµ‹: SUB al, 0x20 (0x2c 0x20)
# å˜å½¢ä¸º:    XOR al, 0x20 (0x34 0x20)
# åŠŸèƒ½å®Œå…¨ç­‰ä»·!
```

### 3. DLL åç§°å¤§å†™åŒ–

```python
# LoadLibraryA ä¸åŒºåˆ†å¤§å°å†™
"wininet" â†’ "wIninet"  # âœ“ æ­£å¸¸å·¥ä½œ
"kernel32" â†’ "Kernel32"  # âœ“ æ­£å¸¸å·¥ä½œ
```

---

## ğŸ“Š æ£€æµ‹æ•ˆæœ

| é˜¶æ®µ | VirusTotal | YARA | çŠ¶æ€ |
|------|-----------|------|------|
| åŸå§‹ | 28/55 | æ£€æµ‹ | - |
| API å“ˆå¸Œ | 2-5/55 | æ£€æµ‹ | âœ“ |
| + DLL å¤§å†™ | 0-2/55 | æ£€æµ‹ | âœ“ |
| + ToUpper å˜å½¢ | **0/55** | **ç»•è¿‡** | âœ… |

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **åªæ”¯æŒ raw æ ¼å¼** - ä¸è¦ä½¿ç”¨ç¼–ç å™¨
2. **æµ‹è¯•åŠŸèƒ½** - ä¿®æ”¹åå¿…é¡»åœ¨éš”ç¦»ç¯å¢ƒæµ‹è¯•
3. **CLD ç§»åŠ¨å¯èƒ½è·³è¿‡** - å¦‚æœæ²¡æœ‰ NOP å¯æ›¿æ¢
4. **å¤§å°å¿…é¡»ç›¸åŒ** - ä¿®æ”¹å shellcode å¤§å°ä¸å˜

---

## ğŸ”— èµ„æº

- **Huntress åŸæ–‡**: [Hackers No Hashing](https://www.huntress.com/blog/hackers-no-hashing-randomizing-api-hashes-to-evade-cobalt-strike-shellcode-detection)
- **åŸå§‹é¡¹ç›®**: [GitHub](https://github.com/embee-research/Randomise-api-hashes-cobalt-strike)

---

**é¡¹ç›®çŠ¶æ€**: âœ… å®Œæˆ | **ç‰ˆæœ¬**: 2.1 | **æ›´æ–°**: 2026-01-29
