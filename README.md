# API å“ˆå¸ŒéšæœºåŒ–

> **åŸºäº Huntress ç ”ç©¶,å®ç° 0/55 VirusTotal æ£€æµ‹çš„ Shellcode ç»•è¿‡å·¥å…·**

âš ï¸ **å…è´£å£°æ˜**: æœ¬å·¥å…·ä»…ç”¨äºæˆæƒçš„å®‰å…¨ç ”ç©¶å’Œæ¸—é€æµ‹è¯•ã€‚ä½¿ç”¨è€…éœ€å¯¹åˆæ³•æ€§è´Ÿè´£ã€‚

## ğŸ¯ åŠŸèƒ½ç‰¹æ€§

| æŠ€æœ¯ | æ•ˆæœ | è¯´æ˜ |
|------|------|------|
| **API å“ˆå¸ŒéšæœºåŒ–** | ç»•è¿‡ 96% | éšæœºåŒ– ROR å€¼å¹¶é‡ç®—å“ˆå¸Œ |
| **DLL åç§°å¤§å†™åŒ–** | æ ˆå­—ç¬¦ä¸²ç»•è¿‡ | LoadLibraryA ä¸åŒºåˆ†å¤§å°å†™ |
| **CLD æŒ‡ä»¤ç§»åŠ¨** | é¦–æŒ‡ä»¤ç»•è¿‡ | åªæ›¿æ¢ä¸æ’å…¥,ä¿æŒå¤§å° |
| **ToUpper å˜å½¢** | YARA ç»•è¿‡ | SUBâ†’XOR,åŠŸèƒ½ç­‰ä»· |

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…

```bash
pip install pefile
python dll_parser.py -v
```

### ä½¿ç”¨

```bash
# æ¨èç”¨æ³• (æœ€å®‰å…¨)
python apihash_zero_detection.py -a x64 -i beacon.bin \
  --uppercase-dlls --transform-toupper

# å®Œæ•´é›¶æ£€æµ‹
python apihash_zero_detection.py -a x64 -i beacon.bin --zero-detection -v
```

### åŸå§‹è„šæœ¬ (å…¼å®¹)

```bash
python apihashreplace.py 64 beacon.bin
```

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
â”œâ”€â”€ apihash_zero_detection.py   # â­ ä¸»è„šæœ¬
â”œâ”€â”€ apihash_lists.py            # API åˆ—è¡¨æ¨¡å—
â”œâ”€â”€ dll_parser.py               # DLL è§£æå·¥å…·
â”œâ”€â”€ apihashreplace.py           # åŸå§‹è„šæœ¬
â”œâ”€â”€ rorHashingDetection.yara    # YARA æ£€æµ‹è§„åˆ™
â”‚
â”œâ”€â”€ é›¶æ£€æµ‹ä½¿ç”¨æŒ‡å—.md           # è¯¦ç»†ä½¿ç”¨æŒ‡å—
â”œâ”€â”€ YARAç»•è¿‡æŒ‡å—.md             # YARA ç»•è¿‡è¯¦è§£
â”œâ”€â”€ åŠ¨æ€DLLè§£ææŒ‡å—.md          # DLL è§£æåŠŸèƒ½
â”œâ”€â”€ è„šæœ¬æ‰§è¡Œå…³ç³»è¯´æ˜.md         # è„šæœ¬ä¾èµ–å…³ç³»
â”œâ”€â”€ é¡¹ç›®æ€»ç»“.md                 # é¡¹ç›®æ¦‚è§ˆ
â””â”€â”€ dll_cache.json              # API ç¼“å­˜ (è‡ªåŠ¨ç”Ÿæˆ)
```

---

## ğŸ“Š æ£€æµ‹æ•ˆæœå¯¹æ¯”

| é˜¶æ®µ | VirusTotal | YARA |
|------|-----------|------|
| åŸå§‹ Shellcode | 55/55 | æ£€æµ‹ |
| + API å“ˆå¸ŒéšæœºåŒ– | 2-5/55 | æ£€æµ‹ |
| + DLL å¤§å†™åŒ– | 0-2/55 | æ£€æµ‹ |
| **+ ToUpper å˜å½¢** | **0/55** | **ç»•è¿‡** |

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **åªæ”¯æŒ raw æ ¼å¼** - ä¸è¦ä½¿ç”¨ç¼–ç å™¨
2. **æµ‹è¯•åŠŸèƒ½** - ä¿®æ”¹åå¿…é¡»åœ¨éš”ç¦»ç¯å¢ƒæµ‹è¯•
3. **å¤§å°ä¸å˜** - ä¿®æ”¹å shellcode å¤§å°åº”ä¸åŸå§‹ç›¸åŒ
4. **CLD å¯èƒ½è·³è¿‡** - å¦‚æœæ²¡æœ‰ NOP å¯æ›¿æ¢

---

## ğŸ”— å‚è€ƒèµ„æº

- **åŸå§‹æ–‡ç« **: [Huntress Blog - Hackers No Hashing](https://www.huntress.com/blog/hackers-no-hashing-randomizing-api-hashes-to-evade-cobalt-strike-shellcode-detection)
- **åŸå§‹é¡¹ç›®**: [embee-research/Randomise-api-hashes-cobalt-strike](https://github.com/embee-research/Randomise-api-hashes-cobalt-strike)

---

## ğŸ“ æ›´æ–°æ—¥å¿—

### v2.1 (2026-01-29)
- âœ… æ–°å¢ ToUpper å‡½æ•°å˜å½¢ (YARA ç»•è¿‡)
- âœ… CLD ç§»åŠ¨æ”¹ä¸ºå®‰å…¨æ›¿æ¢ç­–ç•¥
- âœ… æ‰©å±• DLL åç§°æ”¯æŒ (16 ç§)
- âœ… å®Œå–„å®Œæ•´æ€§éªŒè¯

### v2.0
- âœ… æ–°å¢åŠ¨æ€ DLL è§£æ
- âœ… æ–°å¢ DLL åç§°å¤§å†™åŒ–
- âœ… æ–°å¢ CLD æŒ‡ä»¤ç§»åŠ¨

### v1.0
- åŸå§‹ API å“ˆå¸ŒéšæœºåŒ–è„šæœ¬

---

*æœ€åæ›´æ–°: 2026-01-29*
